WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/victor/anaconda3/envs/nir/lib/python3.11/site-packages/torch/cuda/memory.py:303: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
/home/victor/anaconda3/envs/nir/lib/python3.11/site-packages/torch/cuda/memory.py:303: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
WITHOUT PARALLEL: tensor([[[ -4.8996,   4.5979,  12.1342,  ...,  -7.5213, -10.4715,   2.8730],
         [ -4.9590,   4.5839,  13.0379,  ...,  -2.3923,  -6.8476,   1.5344],
         [ -2.1031,   4.9434,  13.9350,  ...,  -4.5774,  -7.8811,   0.9518],
         ...,
         [ -3.6843,   5.6127,  13.1509,  ...,  -7.8436,  -9.3872,   1.6118],
         [ -2.4917,   4.5311,  12.4982,  ...,  -7.6816, -10.4933,   0.4401],
         [ -3.4169,   5.3822,  15.8859,  ...,  -1.5474,  -8.1179,  -1.8247]],

        [[ -3.4265,   5.4315,  13.4826,  ...,  -5.6195,  -7.4432,   0.6532],
         [ -4.0078,   3.8706,   9.5420,  ..., -11.7352, -12.9432,   3.8802],
         [ -4.2541,   4.9024,  10.9258,  ...,  -9.3171, -10.5209,   3.5633],
         ...,
         [ -4.9248,   5.9967,  12.5194,  ...,  -5.1737,  -7.4841,   2.6231],
         [ -4.2688,   2.7135,  14.0053,  ...,  -1.4048,  -9.1915,  -0.1521],
         [ -5.0057,   4.2292,  15.0444,  ...,  -3.3013,  -8.3295,   1.8785]],

        [[ -2.5419,   5.0202,  12.5326,  ...,  -7.4827, -10.9800,   2.1887],
         [ -2.9061,   4.0889,  14.2218,  ...,  -3.0439,  -9.0436,  -0.2357],
         [ -3.4289,   3.2737,  12.8127,  ...,  -4.7297,  -9.0618,   0.5790],
         ...,
         [ -1.7434,   6.0546,  11.7353,  ...,  -8.5542, -10.5599,   1.8381],
         [ -3.1609,   4.6678,  13.2472,  ...,  -7.1992,  -9.8178,   2.1283],
         [ -3.3026,   5.5481,  16.6956,  ...,  -2.9163,  -6.7993,  -0.1742]],

        ...,

        [[-13.7324,  17.0085,  58.5963,  ..., -11.1499, -33.4005,   0.4441],
         [-14.3193,  14.6195,  51.5568,  ..., -18.4843, -35.4736,   3.1075],
         [-21.6208,  11.6718,  62.3459,  ...,  -3.1729, -24.5205,   1.4077],
         ...,
         [-11.6092,  16.9291,  41.0825,  ..., -41.1143, -42.3115,   7.1332],
         [-13.5461,  15.0521,  52.0622,  ..., -26.9348, -37.5939,   6.3702],
         [-14.0772,  18.9208,  56.6708,  ..., -11.8834, -36.6620,   7.1241]],

        [[-13.5287,  16.8165,  53.7773,  ..., -27.7824, -33.8318,   6.1918],
         [-16.0903,  16.8516,  51.4646,  ..., -13.7213, -33.0984,  -0.9968],
         [-18.9527,  15.9098,  62.1547,  ...,  -5.6172, -30.5106,   2.8989],
         ...,
         [-18.4732,   9.7631,  55.0446,  ..., -18.9127, -33.2167,   3.7248],
         [-14.7784,  15.9440,  58.6436,  ...,  -7.5840, -28.6784,  -1.9648],
         [-14.6030,  15.9840,  52.4963,  ..., -21.0900, -37.8050,   4.2888]],

        [[-11.5753,  17.4864,  46.1907,  ..., -36.0329, -38.6701,   2.5339],
         [-13.4218,  16.2917,  51.5977,  ..., -29.0530, -34.9659,   4.0606],
         [-14.3275,  15.2146,  48.9812,  ..., -32.9149, -37.9928,   7.3883],
         ...,
         [-14.0351,  19.9905,  48.9982,  ..., -29.3234, -35.2960,   5.7614],
         [-15.5624,  16.1663,  53.9079,  ..., -16.8826, -29.6278,   4.4150],
         [-14.5200,  16.2608,  49.9324,  ..., -31.7061, -37.9492,   7.8109]]],
       device='cuda:0', grad_fn=<ReshapeAliasBackward0>)
WITHOUT PARALLEL STATS: time: 0.763, memory: 5.896
WITH PARALLEL: tensor([[[ -4.8996,   4.5979,  12.1342,  ...,  -7.5213, -10.4715,   2.8730],
         [ -4.9590,   4.5839,  13.0379,  ...,  -2.3923,  -6.8476,   1.5344],
         [ -2.1031,   4.9434,  13.9350,  ...,  -4.5774,  -7.8811,   0.9518],
         ...,
         [ -3.6843,   5.6127,  13.1509,  ...,  -7.8436,  -9.3872,   1.6118],
         [ -2.4917,   4.5311,  12.4982,  ...,  -7.6816, -10.4933,   0.4401],
         [ -3.4169,   5.3822,  15.8859,  ...,  -1.5474,  -8.1179,  -1.8247]],

        [[ -3.4265,   5.4315,  13.4826,  ...,  -5.6195,  -7.4432,   0.6532],
         [ -4.0078,   3.8706,   9.5420,  ..., -11.7352, -12.9432,   3.8802],
         [ -4.2541,   4.9024,  10.9258,  ...,  -9.3171, -10.5209,   3.5633],
         ...,
         [ -4.9248,   5.9967,  12.5194,  ...,  -5.1737,  -7.4841,   2.6231],
         [ -4.2688,   2.7135,  14.0053,  ...,  -1.4048,  -9.1915,  -0.1521],
         [ -5.0057,   4.2292,  15.0444,  ...,  -3.3013,  -8.3295,   1.8785]],

        [[ -2.5419,   5.0202,  12.5326,  ...,  -7.4827, -10.9800,   2.1887],
         [ -2.9061,   4.0889,  14.2218,  ...,  -3.0439,  -9.0436,  -0.2357],
         [ -3.4289,   3.2737,  12.8127,  ...,  -4.7297,  -9.0618,   0.5790],
         ...,
         [ -1.7434,   6.0546,  11.7353,  ...,  -8.5542, -10.5599,   1.8381],
         [ -3.1609,   4.6678,  13.2472,  ...,  -7.1992,  -9.8178,   2.1283],
         [ -3.3026,   5.5481,  16.6956,  ...,  -2.9163,  -6.7993,  -0.1742]],

        ...,

        [[-13.7324,  17.0085,  58.5963,  ..., -11.1499, -33.4005,   0.4441],
         [-14.3193,  14.6195,  51.5568,  ..., -18.4843, -35.4736,   3.1075],
         [-21.6208,  11.6718,  62.3459,  ...,  -3.1729, -24.5205,   1.4077],
         ...,
         [-11.6092,  16.9291,  41.0825,  ..., -41.1143, -42.3115,   7.1332],
         [-13.5461,  15.0521,  52.0622,  ..., -26.9348, -37.5939,   6.3702],
         [-14.0772,  18.9208,  56.6708,  ..., -11.8834, -36.6620,   7.1241]],

        [[-13.5287,  16.8165,  53.7773,  ..., -27.7824, -33.8318,   6.1918],
         [-16.0903,  16.8516,  51.4646,  ..., -13.7213, -33.0984,  -0.9968],
         [-18.9527,  15.9098,  62.1547,  ...,  -5.6172, -30.5106,   2.8989],
         ...,
         [-18.4732,   9.7631,  55.0446,  ..., -18.9127, -33.2167,   3.7248],
         [-14.7784,  15.9440,  58.6436,  ...,  -7.5840, -28.6784,  -1.9648],
         [-14.6030,  15.9840,  52.4963,  ..., -21.0900, -37.8050,   4.2888]],

        [[-11.5753,  17.4864,  46.1907,  ..., -36.0329, -38.6701,   2.5339],
         [-13.4218,  16.2917,  51.5977,  ..., -29.0530, -34.9659,   4.0606],
         [-14.3275,  15.2146,  48.9812,  ..., -32.9149, -37.9928,   7.3883],
         ...,
         [-14.0351,  19.9905,  48.9982,  ..., -29.3234, -35.2960,   5.7614],
         [-15.5624,  16.1663,  53.9079,  ..., -16.8826, -29.6278,   4.4150],
         [-14.5200,  16.2608,  49.9324,  ..., -31.7061, -37.9492,   7.8109]]],
       device='cuda:0')
WITH PARALLEL STATS: time: 0.0, memory: 7.137
tensor([[[True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         ...,
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True]],

        [[True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         ...,
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True]],

        [[True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         ...,
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True]],

        ...,

        [[True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         ...,
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True]],

        [[True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         ...,
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True]],

        [[True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         ...,
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True],
         [True, True, True,  ..., True, True, True]]], device='cuda:0')
