# Parallelism in Transformers: My Implementation
![loss](./images//README.png)

### На данный момент реализовано три типа параллелизма:
 1. Тензорный параллелим
 2. Конвейерный параллелизм
 3. параллелим смеси икспертов

| Параметр                                 | DeepSpeed      | New partitionig      | Standard Partitioning      |
|------------------------------------------|--------------------|--------------------|--------------------|
| **Время инференса (s)**                  | 592.807            | 1988.417           | 757.441            |
| **Пропускная способность (token/s)**     | 4.750              | 1.416              | 3.718              |
| **Макс. память на устройство (генератор, ГБ)** | device 0: 2.706<br>device 1: 2.706 | device 0: 2.651<br>device 1: 2.651 | device 0: 2.651<br>device 1: 2.651 |
| **Макс. память на устройство (инференс, ГБ)** | device 0: 3.400<br>device 1: 3.400 | device 0: 3.333<br>device 1: 3.333 | device 0: 4.331<br>device 1: 4.331 |
| **Макс. память на устройство (общая, ГБ)**   | device 0: 3.400<br>device 1: 3.400 | device 0: 3.333<br>device 1: 3.333 | device 0: 4.331<br>device 1: 4.331 |

| Параметр                                 | Sync     | Async      | 
|------------------------------------------|----------|------------|
| **Время инференса (с)**                  | 6.875    | 6.844      | 
| **Пропускная способность (token/s)**     | 13.964   | 14.026     | 
| **Макс. память на устройство (генератор, ГБ)** | device 0: 2.650<br>device 1: 2.635 | device 0: 2.650<br>device 1: 2.635 | 
| **Макс. память на устройство (инференс, ГБ)** | device 0: 2.827<br>device 1: 2.812 | device 0: 3.934<br>device 1: 3.917 | 
| **Макс. память на устройство (общая, ГБ)**   | device 0: 2.827<br>device 1: 2.812 | device 0: 3.934<br>device 1: 3.917 |

| Параметр                                 | DeepSpeed      | New partitionig      | Standard Partitioning      | Pipeline |
|------------------------------------------|----------------|----------------------|---------------------------|----------|
| **Время инференса (s)**                  | 592.807        | 1988.417             | 757.441                   | 651.239  |
| **Пропускная способность (token/s)**     | 4.750          | 1.416                | 3.718                     | 4.717    |
| **Макс. память на устройство (генератор, ГБ)** | device 0: 2.706<br>device 1: 2.706 | device 0: 2.651<br>device 1: 2.651 | device 0: 2.651<br>device 1: 2.651 | device 0: 2.650<br>device 1: 2.635 |
| **Макс. память на устройство (инференс, ГБ)** | device 0: 3.400<br>device 1: 3.400 | device 0: 3.333<br>device 1: 3.333 | device 0: 4.331<br>device 1: 4.331 | device 0: 3.407<br>device 1: 3.391 |
| **Макс. память на устройство (общая, ГБ)**   | device 0: 3.400<br>device 1: 3.400 | device 0: 3.333<br>device 1: 3.333 | device 0: 4.331<br>device 1: 4.331 | device 0: 3.407<br>device 1: 3.391 |


**Тема ВКР:** Оптимизация распределённого инференса больших языковых моделей с архитектурой Mixture of Experts


