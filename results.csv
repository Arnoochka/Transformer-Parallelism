name,time,memory_gpu_0,max_memory_gpu_0,memory_gpu_1,max_memory_gpu_1
start,8920.923653696,1.1329984664916992,1.1330008506774902,0.8750638961791992,0.8750662803649902
start forward,8920.991321117,0.7595248222351074,1.1329994201660156,0.5095248222351074,0.8750648498535156
full top k index,8920.993426407,0.7600140571594238,0.7600164413452148,0.5100140571594238,0.5100164413452148
final hidden states,8920.994972653,0.8850150108337402,0.8850173950195312,0.6350150108337402,0.6350173950195312
sort global ranks,8921.024218755,0.8857483863830566,0.8864974975585938,0.6357483863830566,0.6364974975585938
need indicies,8921.028511041,0.8859086036682129,0.8863425254821777,0.6358346939086914,0.6361947059631348
local sorted ranks,8921.029779579,0.8861536979675293,0.8865327835083008,0.6360797882080078,0.6364588737487793
bincount,8921.051498519,0.8861551284790039,0.8861575126647949,0.6360812187194824,0.6360836029052734
recv counts,8921.052687188,0.8861565589904785,0.8861589431762695,0.636082649230957,0.636085033416748
counts.tolist,8921.056687623,0.8861565589904785,0.8862953186035156,0.636082649230957,0.6362214088439941
need hidden states,8921.057892486,1.04896879196167,1.048971176147461,0.7232723236083984,0.7232747077941895
expert mask,8921.063633516,1.0496058464050293,1.0497651100158691,0.7236142158508301,0.7236995697021484
first all2all,8921.246390845,1.0496068000793457,1.1746068000793457,0.7236151695251465,0.8486151695251465
compute,8921.441857223,1.049607753753662,2.189446449279785,0.7236161231994629,1.3338627815246582
computed hidden states,8921.443059573,1.1746087074279785,1.1746110916137695,0.8486170768737793,0.8486194610595703
second all2all,8921.576337594,1.174609661102295,1.174612045288086,0.8486180305480957,0.8486204147338867
final mul,8921.578570448,1.1746106147766113,1.1746716499328613,0.8486189842224121,0.8486800193786621
final add,8921.626259593,1.1746115684509277,1.1746139526367188,0.8486199378967285,0.8486223220825195
sort global ranks,8921.6279057,1.1748566627502441,1.1760940551757812,0.8488650321960449,0.850102424621582
need indicies,8921.629556175,1.174783706665039,1.1753029823303223,0.8489398956298828,0.849459171295166
local sorted ranks,8921.630785487,1.1747846603393555,1.175407886505127,0.8489408493041992,0.8495640754699707
bincount,8921.632144212,1.17478609085083,1.174788475036621,0.8489422798156738,0.8489446640014648
recv counts,8921.633256645,1.1747875213623047,1.1747899055480957,0.8489437103271484,0.8489460945129395
counts.tolist,8921.634617585,1.1745433807373047,1.174788475036621,0.8486995697021484,0.8489446640014648
need hidden states,8921.635729652,1.098921775817871,1.261733055114746,0.9245061874389648,1.0116949081420898
expert mask,8921.636941238,1.0986266136169434,1.0993480682373047,0.9248032569885254,0.9253034591674805
first all2all,8921.752034204,1.0986275672912598,1.2236275672912598,0.9248042106628418,1.0498042106628418
compute,8921.946836155,1.0986285209655762,1.7075934410095215,0.9248051643371582,2.062346935272217
computed hidden states,8921.948042334,1.0986294746398926,1.2236294746398926,0.9248061180114746,1.0498061180114746
second all2all,8922.062218459,1.098630428314209,1.0986328125,0.924807071685791,0.924809455871582
final mul,8922.067035217,1.0986313819885254,1.0986924171447754,0.9248080253601074,0.9248690605163574
final add,8922.070845056,1.0986323356628418,1.0986347198486328,0.9248089790344238,0.9248113632202148
return,8922.071915733,1.0986332893371582,1.0986356735229492,0.9248099327087402,0.9248123168945312
